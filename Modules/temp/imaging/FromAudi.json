{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "imageTemplateName": {
            "type": "string",
            "defaultValue": "vs2019-25"
        },
        "location": {
            "type": "string",
            "defaultValue": "eastus2"
        }
    },

    "variables": {
        "text": "test text",
        "image_folder": "C:\\image",
        "commit_file": "C:\\image\\commit.txt",
        "metadata_file": "C:\\image\\metadata.txt",
        "commit_id": "LATEST",
        "install_user": "installer",
        "install_password": "",
        "image_version": "dev"
    },
    "resources": [
        {
            "name": "[parameters('imageTemplateName')]",
            "type": "Microsoft.VirtualMachineImages/imageTemplates",
            "apiVersion": "2019-05-01-preview",
            "location": "[parameters('location')]",
            "dependsOn": [
            ],
            "properties": {
                "buildTimeoutInMinutes": 960, //0-960, 0 means the default 240 minutes
                "vmProfile": {
                    "vmSize": "Standard_D3_v2",
                    "osDiskSizeGB": 127
                },
                "source": {
                    "type": "PlatformImage",
                    "publisher": "MicrosoftWindowsServer",
                    "offer": "WindowsServer",
                    "sku": "2019-Datacenter",
                    "version": "17763.914.1912042330"
                },
                "customize": [
                    // {
                    //     "type": "PowerShell",
                    //     "name": "CreateBuildPath",
                    //     "scriptUri": "https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/testPsScript.ps1"
                    // },
                    // {
                    //     "type": "WindowsRestart",
                    //     "restartCheckCommand": "[concat('echo Azure-Image-Builder-Restarted-the-VM ', variables('text'), '  > c:\\buildArtifacts\\azureImageBuilderRestart.txt')]",
                    //     "restartTimeout": "5m"
                    // },
                    // {
                    //     "type": "File",
                    //     "name": "download-BuildArtifacts",
                    //     "sourceUri": "https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/exampleArtifacts/buildArtifacts/index.html",
                    //     "destination": "c:\\buildArtifacts\\index.html"
                    // },
                    // {
                    //     "type": "PowerShell",
                    //     "name": "settingUpMgmtAgtPath",
                    //     "inline": [
                    //         "mkdir c:\\buildActions",
                    //         "[concat('echo Azure-Image-Builder-Was-Here ', variables('text'), ' >> c:\\buildActions\\buildActionsOutput.txt')]"
                    //     ]
                    // },
                    //imported from original github script
                    {
                        "type": "PowerShell",
                        "name": "createImageFolder",
                        "inline": [
                            "[concat( 'New-Item -Path \"', variables('image_folder'), '\" -ItemType Directory -Force' )]",
                            "[concat( 'Write-Output ', variables('commit_id'), ' > ', variables('commit_file') )]",
                            "[concat( 'Write-Host (Get-Content -Path ', variables('commit_file'), ' )' )]"
                        ]
                    },
                    {
                        "type": "PowerShell",
                        "name": "createTestFolderInWindowsPowerShellModules",
                        "inline": [
                            "New-Item -Path \"C:\\Program Files\\WindowsPowerShell\\Modules\\ImageHelpers\\Test\" -ItemType Directory -Force"
                        ]
                    },
                    {
                        "type": "File",
                        "name": "download-ImageHelpers.psd1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/ImageHelpers/ImageHelpers.psd1",
                        "destination": "C:\\Program Files\\WindowsPowerShell\\Modules\\ImageHelpers\\ImageHelpers.psd1"
                    },
                    {
                        "type": "File",
                        "name": "download-ImageHelpers.psm1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/ImageHelpers/ImageHelpers.psm1",
                        "destination": "C:\\Program Files\\WindowsPowerShell\\Modules\\ImageHelpers\\ImageHelpers.psm1"
                    },
                    {
                        "type": "File",
                        "name": "download-InstallHelpers.ps1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/ImageHelpers/InstallHelpers.ps1",
                        "destination": "C:\\Program Files\\WindowsPowerShell\\Modules\\ImageHelpers\\InstallHelpers.ps1"
                    },
                    {
                        "type": "File",
                        "name": "download-MarkdownHelpers.ps1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/ImageHelpers/MarkdownHelpers.ps1",
                        "destination": "C:\\Program Files\\WindowsPowerShell\\Modules\\ImageHelpers\\MarkdownHelpers.ps1"
                    },
                    {
                        "type": "File",
                        "name": "download-PathHelpers.ps1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/ImageHelpers/PathHelpers.ps1",
                        "destination": "C:\\Program Files\\WindowsPowerShell\\Modules\\ImageHelpers\\PathHelpers.ps1"
                    },
                    {
                        "type": "File",
                        "name": "download-ImageHelpers.Tests.ps1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/ImageHelpers/test/ImageHelpers.Tests.ps1",
                        "destination": "C:\\Program Files\\WindowsPowerShell\\Modules\\ImageHelpers\\Test\\ImageHelpers.Tests.ps1"
                    },
                    {
                        "type": "File",
                        "name": "download-PathHelpers.Tests.ps1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/ImageHelpers/test/PathHelpers.Tests.ps1",
                        "destination": "C:\\Program Files\\WindowsPowerShell\\Modules\\ImageHelpers\\Test\\PathHelpers.Tests.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "createAdminUser",
                        "inline": [
                            "[concat('net user ', variables('install_user'), ' ',  variables('install_password'), ' /add /passwordchg:no /passwordreq:yes /active:yes /Y')]",
                            "[concat('net localgroup Administrators ', variables('install_user'), ' /add')]",
                            "winrm set winrm/config/service/auth @{Basic=\"true\"}",
                            "winrm get winrm/config/service/auth"
                        ]
                    },
                    {
                        "type": "PowerShell",
                        "name": "exitIfNewUserIsNotAdmin",
                        "inline": [
                            "[concat('if (-not ((net localgroup Administrators) -contains ''', variables('install_user'), ''')) { exit 1 }')]"
                        ]
                    },
                    {
                        "type": "File",
                        "name": "download-Initialize-VM.ps1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Windows2019/Initialize-VM.ps1",
                        "destination": "[concat( variables('image_folder'), '\\Initialize-VM.ps1' )]"
                    },
                    {
                        "type": "PowerShell",
                        "name": "runInitialize-VM.ps1",
                        "inline": [
                            "[concat( '$env:ImageVersion = \"', variables('image_version') , '\"' )]",
                            "[concat( variables('image_folder'), '\\Initialize-VM.ps1' )]"
                        ]
                    },
                    // {
                    //     "type": "PowerShell",
                    //     "name": "Initialize-VM.ps1",
                    //     "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Windows2019/Initialize-VM.ps1"
                    // },
                    {
                        "type": "WindowsRestart",
                        "restartTimeout": "10m"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-ContainersFeature.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-ContainersFeature.ps1"
                    },
                    {
                        "type": "WindowsRestart",
                        "restartTimeout": "30m"
                    },
                    {
                        "type": "PowerShell",
                        "name": "setImageVersion",
                        "inline": [
                            "[concat('setx ImageVersion ', variables('image_version'), ' /m')]"
                        ]
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Docker.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Docker.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-PowershellCore.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-PowershellCore.ps1"
                    },
                    {
                        "type": "WindowsRestart",
                        "restartTimeout": "20m"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Docker.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Docker.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-PowershellCore.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-PowershellCore.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Update-DockerImages.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Windows2019/Update-DockerImages.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-WDK.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Windows2019/Install-WDK.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-VS2019.ps1",
                        "validExitCodes": [
                            0,
                            3010
                        ],
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Windows2019/Install-VS2019.ps1",
                        // "elevated_user": "{{user `install_user`}}",
                        // "elevated_password": "{{user `install_password`}}",
                        "runElevated": true
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Wix.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Windows2019/Install-Wix.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-NET48.ps1",
                        "validExitCodes": [
                            0,
                            3010
                        ],
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-NET48.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-ServiceFabricSDK.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-ServiceFabricSDK.ps1"
                    },
                    {
                        "type": "WindowsRestart",
                        "restartTimeout": "20m"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Wix.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Windows2019/Validate-Wix.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-NET48.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-NET48.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-WDK.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Windows2019/Validate-WDK.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-ServiceFabricSDK.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-ServiceFabricSDK.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Update-DotnetTLS.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Update-DotnetTLS.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-AzureCli.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-AzureCli.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-AzureDevOpsCli.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-AzureDevOpsCli.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Download-ToolCache.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Download-ToolCache.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Python.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Windows2019/Install-Python.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Git.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Git.ps1"
                    },
                    {
                        "type": "File",
                        "name": "download-Install-Go.ps1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Go.ps1",
                        "destination": "[concat( variables('image_folder'), '\\Install-Go.ps1' )]"
                    },
                    {
                        "type": "PowerShell",
                        "name": "run-Install-Go.ps1",
                        "inline": [
                            "[concat('$env:GO_VERSIONS = \"1.10.8,1.11.12,1.12.7,1.13\"')]",
                            "[concat('$env:GO_DEFAULT = \"1.12.7\"')]",
                            "[concat( variables('image_folder'), '\\Install-Go.ps1' )]"
                        ]
                    },
                    // {
                    //     "type": "PowerShell",
                    //     "name": "Install-Go.ps1",
                    //     "environment_vars": [
                    //         "GO_VERSIONS=1.10.8,1.11.12,1.12.7,1.13",
                    //         "GO_DEFAULT=1.12.7"
                    //     ],
                    //     "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Go.ps1"
                    // },
                    {
                        "type": "PowerShell",
                        "name": "Install-PHP.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-PHP.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Ruby.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Ruby.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Rust.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Rust.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Sbt.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Sbt.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Svn.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Svn.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Chrome.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Chrome.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Firefox.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Firefox.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-SeleniumWebDrivers.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-SeleniumWebDrivers.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Enable-DeveloperMode.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Enable-DeveloperMode.ps1",
                        "runElevated": true
                        // "elevated_user": "{{user `install_user`}}",
                        // "elevated_password": "{{user `install_password`}}"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-WinAppDriver.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-WinAppDriver.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-WinAppDriver.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-WinAppDriver.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-NodeLts.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-NodeLts.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-JavaTools.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-JavaTools.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Cmake.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Cmake.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-DACFx.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-DACFx.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Update-AndroidSDK.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Update-AndroidSDK.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-MysqlCli.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-MysqlCli.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-SQLPowerShellTools.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-SQLPowerShellTools.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-DotnetSDK.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-DotnetSDK.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-WindowsUpdates.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-WindowsUpdates.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "inline": [
                            "wmic product where \"name like '%%microsoft azure powershell%%'\" call uninstall /nointeractive"
                        ]
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-AzureModules.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-AzureModules.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-MinGW.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-MinGW.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-TypeScript.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-TypeScript.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Miniconda.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Miniconda.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-AzureCosmosDbEmulator.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-AzureCosmosDbEmulator.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-7zip.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-7zip.ps1"
                    },
                    {
                        "type": "File",
                        "name": "download-Install-Boost.ps1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Boost.ps1",
                        "destination": "[concat( variables('image_folder'), '\\Install-Boost.ps1' )]"
                    },
                    {
                        "type": "PowerShell",
                        "name": "run-Install-Boost.ps1",
                        "inline": [
                            "[concat('$env:BOOST_VERSIONS = \"1.69.0\"')]",
                            "[concat('$env:BOOST_DEFAULT = \"1.69.0\"')]",
                            "[concat( variables('image_folder'), '\\Install-Boost.ps1' )]"
                        ]
                    },
                    // {
                    //     "type": "PowerShell",
                    //     "name": "Install-Boost.ps1",
                    //     "environment_vars": [
                    //         "BOOST_VERSIONS=1.69.0",
                    //         "BOOST_DEFAULT=1.69.0"
                    //     ],
                    //     "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Boost.ps1"
                    // },
                    {
                        "type": "PowerShell",
                        "name": "Install-Mercurial.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Mercurial.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Jq.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Jq.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-InnoSetup.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-InnoSetup.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Perl.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Perl.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-GitVersion.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-GitVersion.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-OpenSSL.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-OpenSSL.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-NSIS.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-NSIS.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-CloudFoundryCli.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-CloudFoundryCli.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Vcpkg.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Vcpkg.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-KubernetesCli.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-KubernetesCli.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Install-Kind.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Install-Kind.ps1"
                    },
                    {
                        "type": "WindowsRestart",
                        "restartTimeout": "20m"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-AzureModules.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-AzureModules.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-DotnetTLS.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-DotnetTLS.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-AzureCli.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-AzureCli.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-AzureDevOpsCli.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-AzureDevOpsCli.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-ToolCache.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-ToolCache.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Python.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Python.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Git.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Git.ps1"
                    },
                    {
                        "type": "File",
                        "name": "download-Validate-Go.ps1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Go.ps1",
                        "destination": "[concat( variables('image_folder'), '\\Validate-Go.ps1' )]"
                    },
                    {
                        "type": "PowerShell",
                        "name": "run-Validate-Go.ps1",
                        "inline": [
                            "[concat('$env:GO_VERSIONS = \"1.10.8,1.11.12,1.12.7,1.13\"')]",
                            "[concat('$env:GO_DEFAULT = \"1.12.7\"')]",
                            "[concat( variables('image_folder'), '\\Validate-Go.ps1' )]"
                        ]
                    },
                    // {
                    //     "type": "PowerShell",
                    //     "name": "Validate-Go.ps1",
                    //     "environment_vars": [
                    //         "GO_VERSIONS=1.10.8,1.11.12,1.12.7,1.13",
                    //         "GO_DEFAULT=1.12.7"
                    //     ],
                    //     "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Go.ps1"
                    // },
                    {
                        "type": "File",
                        "name": "download-Validate-Boost.ps1",
                        "sourceUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Boost.ps1",
                        "destination": "[concat( variables('image_folder'), '\\Validate-Boost.ps1' )]"
                    },
                    {
                        "type": "PowerShell",
                        "name": "run-Validate-Boost.ps1",
                        "inline": [
                            "[concat('$env:BOOST_VERSIONS = \"1.69.0\"')]",
                            "[concat('$env:BOOST_DEFAULT = \"1.69.0\"')]",
                            "[concat( variables('image_folder'), '\\Validate-Boost.ps1' )]"
                        ]
                    },
                    // {
                    //     "type": "PowerShell",
                    //     "name": "Validate-Boost.ps1",
                    //     "environment_vars": [
                    //         "BOOST_VERSIONS=1.69.0",
                    //         "BOOST_DEFAULT=1.69.0"
                    //     ],
                    //     "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Boost.ps1"
                    // },
                    {
                        "type": "PowerShell",
                        "name": "Validate-PHP.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-PHP.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Ruby.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Ruby.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Rust.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Rust.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Svn.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Svn.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Sbt.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Sbt.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Chrome.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Chrome.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Firefox.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Firefox.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-SeleniumWebDrivers.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-SeleniumWebDrivers.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-NodeLts.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-NodeLts.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-JavaTools.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-JavaTools.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Cmake.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Cmake.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-DACFx.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-DACFx.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-DotnetSDK.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-DotnetSDK.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-MysqlCli.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-MysqlCli.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-SQLPowerShellTools.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-SQLPowerShellTools.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-MinGW.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-MinGW.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-TypeScript.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-TypeScript.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Miniconda.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Miniconda.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-AzureCosmosDbEmulator.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-AzureCosmosDbEmulator.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-7zip.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-7zip.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Mercurial.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Mercurial.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Jq.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Jq.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-InnoSetup.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-InnoSetup.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Perl.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Perl.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-GitVersion.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-GitVersion.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-OpenSSL.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-OpenSSL.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-NSIS.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-NSIS.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-CloudFoundryCli.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-CloudFoundryCli.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Vcpkg.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Vcpkg.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-KubernetesCli.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-KubernetesCli.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Validate-Kind.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Validate-Kind.ps1"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Finalize-VM.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Finalize-VM.ps1"
                    },
                    {
                        "type": "WindowsRestart",
                        "restartTimeout": "20m"
                    },
                    {
                        "type": "PowerShell",
                        "name": "Run-Antivirus.ps1",
                        "scriptUri": "https://raw.githubusercontent.com/actions/virtual-environments/master/images/win/scripts/Installers/Windows2019/Run-Antivirus.ps1"
                    }
                ],
                "distribute": [
                    {
                        "type": "SharedImage",
                        "galleryImageId": "/subscriptions/3fb93bd4-2dd2-4b12-afba-3dd335c8154d/resourceGroups/omv-sb-ccoe-np-01-euw-rg-validate-np-01/providers/Microsoft.Compute/galleries/sig/images/winSrv2019TstImg",
                        "runOutputName": "winSrv2019TstImg-gallery",
                        "artifactTags": {
                            "source": "azureVmImageBuilder",
                            "baseosimg": "windows2019"
                        },
                        "replicationRegions": [
                            "[parameters('location')]",
                            // "westeurope"
                        ]
                    },
                    // {
                    //     "type": "ManagedImage",
                    //     "imageId": "/subscriptions/3fb93bd4-2dd2-4b12-afba-3dd335c8154d/resourceGroups/omv-sb-ccoe-np-01-euw-rg-validate-np-01/providers/Microsoft.Compute/images/winSrv2019TstImg",
                    //     "location": "[parameters('location')]",
                    //     "runOutputName": "winSrv2019TstImg-managedimage",
                    //     "artifactTags": {
                    //         "source": "azVmImageBuilder",
                    //         "baseosimg": "windows2019"
                    //     }
                    // }
                ]
            }
        }
    ]
}
